<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>DTSEN Dashboard</title>
  <!-- AdminLTE & dependencies -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/css/adminlte.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap4.min.css">
</head>
<body class="hold-transition sidebar-mini">
<div class="wrapper">

  <!-- Content Wrapper -->
  <div class="content-wrapper p-3">

    <!-- Scorecards -->
    <div class="row">
      <div class="col-lg-3 col-6">
        <div class="small-box bg-info">
          <div class="inner">
            <h3 id="totalSurat">0</h3>
            <p>Total Surat</p>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-6">
        <div class="small-box bg-success">
          <div class="inner">
            <h3 id="bastSelesai">0</h3>
            <p>BAST Selesai</p>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-6">
        <div class="small-box bg-warning">
          <div class="inner">
            <h3 id="sedangProses">0</h3>
            <p>Sedang Proses</p>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-6">
        <div class="small-box bg-primary">
          <div class="inner">
            <h3 id="jumlahLembaga">0</h3>
            <p>Jumlah Lembaga</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Table -->
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Daftar Surat Terbaru</h3>
      </div>
      <div class="card-body">
        <table id="tabelSurat" class="table table-bordered table-striped">
          <thead>
            <tr>
              <th>No</th>
              <th>Lembaga</th>
              <th>Tanggal</th>
              <th>Nama</th>
              <th>Keterangan</th>
              <th>BAST</th>
            </tr>
          </thead>
          <tbody>
            <!-- data dari Google Sheet masuk sini -->
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- JS dependencies -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/js/adminlte.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap4.min.js"></script>

<script>
// Ganti dengan ID Sheet kamu
const SHEET_ID = "1fpkO2nodFJNPp71C12LZLxsqsJ8rt9G-wRVSwwugwoc";
const SHEET_RANGE = "BAST!A7:I100"; // sesuaikan range
const API_KEY = "YOUR_GOOGLE_API_KEY"; // isi nanti

// Fetch data dari Google Sheets
async function loadData() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_RANGE}?key=${API_KEY}`;
  const res = await fetch(url);
  const data = await res.json();

  if (!data.values) return;

  let rows = data.values.slice(1); // skip header
  let tbody = document.querySelector("#tabelSurat tbody");
  tbody.innerHTML = "";

  let total = rows.length;
  let selesai = rows.filter(r => r[8] && r[8].toLowerCase().includes("selesai")).length;
  let proses = total - selesai;
  let lembaga = new Set(rows.map(r => r[1])).size;

  // Update scorecards
  document.getElementById("totalSurat").innerText = total;
  document.getElementById("bastSelesai").innerText = selesai;
  document.getElementById("sedangProses").innerText = proses;
  document.getElementById("jumlahLembaga").innerText = lembaga;

  // Populate table
  rows.forEach(r => {
    tbody.innerHTML += `
      <tr>
        <td>${r[0]}</td>
        <td>${r[1]}</td>
        <td>${r[2]}</td>
        <td>${r[3]}</td>
        <td>${r[4]}</td>
        <td>${r[8]}</td>
      </tr>`;
  });

  // Init DataTable
  $("#tabelSurat").DataTable();
}

loadData();
</script>
</body>
</html>
